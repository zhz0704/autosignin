# 自動簽到工具
## 這到底是三小
因為我一直忘記簽到，所以想說寫個程式自動簽到。原本是想用 `Selenium` 的，但是 Google 登入太麻煩了而且有人可能會有 2FA 等等問題所以就放棄這個方向了，最後決定用模擬使用者輸入的方式進行簽到，簡單來說就是個點擊腳本。這個腳本具底在幹嘛請見[詳細步驟](#詳細步驟)。

## 注意事項

為了確保這個腳本能動，請先確認以下事項：
* 你的電腦必須有 Edge。
應該是不會有人在公司的電腦刪掉 Edge 吧，所以我選擇用 Edge。
* 你的 Edge 必須已經登入好 Google 帳號，且只能登入一個。
這樣是確保在報班系統按登入時，能直接登入。如果有多個 Google 帳號，還會需要選你要用哪個帳號登入系統。
* 因為我會用到 `F12`，但是第一次開的時候會有彈窗問你要不要用，所以你必須手動打開 `F12` 一次然後記得選之後不要再問。
* 為了避免輸入法的問題，這個腳本裡面所有需要打字的部分都是使用複製貼上，但 console 預設是不能貼上的，所以你必須先到 console 打 `allow pasting` （或是 `允許貼上`，如果你是中文的話），然後確認真的可以貼上東西。

## Disclaimer
你如果使用這個腳本導致沒有報到班、報錯班等等，這鍋我不背。好啦開個玩笑如果真的不幸發生了我很抱歉，然後也請你回報 bug 給我。

## Install
```bash
pip install -r requirements.txt
```
## Usage
```bash
python autosignin.py [-s <value> | --speed <value>]
```
參數
* `-s`, `--speed`: optional, 預設為 `1.0`。這個腳本在點擊按鍵中間會有延遲，因為要等瀏覽器開啟、網頁載入等等。但每個人電腦、網路狀況都不一樣，所以需要等待的時間可能都不一樣。如果覺得執行速度太快，可以把這個參數調低，反之亦然。

開始跑直到結束之前記得不要動滑鼠或鍵盤。

## 詳細步驟
因為每個人的視窗大小、縮放等等都不一樣，所以按鈕的位置也都不一樣，所以我極力避免使用到滑鼠，一且操作全部使用鍵盤的 `Tab` 跟 `Enter` 進行。
1. 按 `Win` 並搜尋 Edge
2. 貼上網址，進到報班系統
3. 按右上角的登入
4. 新增班表
這邊就是整個腳本最麻煩的部分了，新增班表的那個日曆沒辦法用 `Tab` 選進去，所以我試了很多方法，終於試出來一個可行的。按下新增按鈕的時候，實際上是丟一個 `POST` request，裡面有日期，當然還有最重要的 `token`，用來驗證你是誰。非常幸運的，他這個 token 直接寫在 `HTML` 裡面，所以算是省了很多麻煩。
<br>(1) 切換到新增班表的頁面
<br>(2) 按 `Ctrl` + `u` 以檢視網頁的 `HTML`，他會開在新的分頁
<br>(3) 複製下來並抓出 `token`
<br>(4) 按 `Ctrl` + `w` 關掉分頁
<br>(5) 按 `Ctrl` + `Shift` + `j` 打開 console
<br>(6) 貼上 `JavaScript` code， 丟一個 `POST` request
6. 切回去主頁並簽到
